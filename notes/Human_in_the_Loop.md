# Human-in-the-Loop (HITL) 가이드

`Human-in-the-Loop (HITL)`는 **AI 시스템의 특정 단계에서 인간이 개입하여 판단, 승인, 수정을 수행하는 구조**를 말합니다. 자동화된 시스템과 인간의 결정을 결합하여, 정확성, 신뢰성, 윤리성을 강화하고 실사용 상황에서 발생할 수 있는 문제를 효과적으로 제어할 수 있습니다.

---

## ✅ HITL란?

| 항목      | 설명                                                                                   |
| --------- | -------------------------------------------------------------------------------------- |
| 정의      | AI 추론이나 행동 흐름 중 **중요한 지점에서 인간의 개입을 허용**하는 시스템 디자인 방식 |
| 목적      | 자동화된 AI 결정에 대한 **보증, 해석, 윤리적 통제** 수행                               |
| 적용 영역 | 고위험 의사결정, 민감 데이터 처리, 복잡한 추론 등                                      |

---

## 🧠 HITL이 필요한 이유

| 문제        | HITL 도입 효과                                 |
| ----------- | ---------------------------------------------- |
| 잘못된 추론 | 사람이 직접 확인하고 수정 가능                 |
| 낮은 신뢰도 | 사용자가 개입함으로써 책임 소재 명확화         |
| 윤리적 위험 | 차별, 조작 등 위험에 대한 사전 제어            |
| 모호한 상황 | 명확한 도구/프롬프트로도 해결 어려운 경우 개입 |

---

## 🧩 HITL 적용 방식

### 1. **사전 승인 방식 (Pre-validation)**

- AI가 추론한 결과에 대해 **최종 출력 전 인간 승인 요청**
- 예: 법률 문서 요약 후 변호사 승인 필요

### 2. **조건부 개입 방식 (Conditional Intervention)**

- 특정 조건(불확실성, 민감 키워드 등)이 충족될 경우만 개입
- 예: “50% 이하 confidence”일 경우만 인간 질문 전송

### 3. **후처리 감수 방식 (Post-review)**

- 생성된 출력에 대해 사용자 피드백 또는 감수 과정을 추가
- 예: 뉴스 초안 생성 후 기자가 검토

### 4. **상호 작용 기반 방식 (Interactive Agent)**

- 에이전트가 진행 중 특정 질문을 사용자에게 직접 되묻는 방식
- 예: LangChain/LangGraph에서 `AskHuman` 도구 사용

---

## ⚙️ LangGraph에서 HITL 구현 예시

```python
from langgraph.prebuilt import ToolNode
from langchain_core.tools import tool

@tool
def AskHuman(message: str) -> str:
    # 실제로는 프론트엔드 또는 콘솔 입력 등과 연결됨
    return input(f"[HITL 요청]: {message}\n> ")

tools = [AskHuman]
tool_node = ToolNode(tools)
```

- 에이전트가 확신이 없을 경우 `AskHuman` 도구를 호출
- 사용자 응답을 기반으로 다음 추론 단계 진행

---

## ✅ HITL이 유용한 분야

| 분야      | 설명                                    |
| --------- | --------------------------------------- |
| 법률/의료 | 민감하고 고위험 판단이 요구됨           |
| 금융      | 규제 요건 하에서 감사 가능한 결정 필요  |
| 제조      | 품질 검사, 위험 감지에 사람의 판단 필요 |
| 생성 AI   | 창작물에 대한 품질 및 검열 필요         |

---

## 🧠 HITL의 과제

| 과제           | 설명                                            |
| -------------- | ----------------------------------------------- |
| 개입 시점 결정 | 언제 사람이 개입해야 할지 기준 정의 필요        |
| UX/UI 통합     | 사용자 응답을 효과적으로 받아들이는 채널 필요   |
| 비용 문제      | 사람이 자주 개입할수록 시스템 자동화 수준 저하  |
| 신뢰 통제 설계 | 사람이 AI 출력을 신뢰하게 만드는 방식 설계 필요 |

---

## 📌 결론

- HITL은 AI 시스템이 신뢰성과 안전성을 갖추기 위해 **반드시 고려되어야 할 설계 요소**입니다.
- LangGraph, LangChain 등의 프레임워크는 `AskHuman`과 같은 방식으로 쉽게 HITL을 구성할 수 있습니다.
- 핵심은 "언제", "어떻게" 사람을 개입시키고, **개입한 정보를 어떻게 상태에 통합할 것인지**를 정의하는 것입니다.

---

Human-in-the-Loop는 단순히 AI가 사람을 돕는 것이 아니라, 사람이 AI의 일부 흐름을 통제함으로써 **사람과 AI가 협력하는 구조를 만드는 핵심 기술**입니다.
